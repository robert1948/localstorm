import{r as a,u as T,j as e}from"./index-BUM12w8y.js";const q="https://www.cape-control.com/api";async function $(t){try{const r=await fetch(`${q}/auth/v2/validate-email?email=${encodeURIComponent(t)}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error("Email validation failed");return await r.json()}catch(r){return console.error("Email validation error:",r),{available:null,reason:"validation_error",message:"Unable to validate email. Please try again."}}}async function V(t){try{const r=await fetch(`${q}/auth/v2/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok){const l=await r.json();throw new Error(l.detail||"Registration failed")}return await r.json()}catch(r){throw console.error("Registration error:",r),r}}function L({currentStep:t,totalSteps:r}){const l=t/r*100;return e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-4",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300 ease-in-out",style:{width:`${l}%`}})})}function F({password:t}){const l=(m=>{let s=0;return m.length>=12&&(s+=25),/[a-z]/.test(m)&&(s+=25),/[A-Z]/.test(m)&&(s+=25),/[0-9]/.test(m)&&(s+=15),/[^A-Za-z0-9]/.test(m)&&(s+=10),Math.min(s,100)})(t),i=()=>l<30?{label:"Weak",color:"bg-red-500"}:l<60?{label:"Fair",color:"bg-yellow-500"}:l<80?{label:"Good",color:"bg-blue-500"}:{label:"Strong",color:"bg-green-500"},{label:g,color:o}=i();return t?e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Password Strength"}),e.jsx("span",{children:g})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:e.jsx("div",{className:`h-1 rounded-full transition-all duration-300 ${o}`,style:{width:`${l}%`}})})]}):null}function z({email:t,isValid:r,isChecking:l}){return t?e.jsx("div",{className:"mt-1 text-xs flex items-center",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin h-3 w-3 border border-blue-500 rounded-full border-t-transparent mr-2"}),e.jsx("span",{className:"text-gray-500",children:"Checking availability..."})]}):r===!0?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-3 w-3 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-green-600",children:"✓ Email available"})]}):r===!1?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-3 w-3 text-red-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-red-600",children:"Email already registered"})]}):null}):null}function A({role:t,selectedRole:r,onSelect:l}){const i=r===t,o={customer:{title:"Customer",icon:"👤",description:"Access pre-built AI agents to automate business processes. No coding required.",features:["Ready-to-use AI agents","Business process automation","Easy-to-use dashboard","No technical knowledge needed"],color:"blue"},developer:{title:"Developer",icon:"👨‍💻",description:"Build custom AI agents with developer tools. Earn 30% revenue share.",features:["Build custom AI agents","30% revenue sharing","Developer tools & APIs","Marketplace publishing"],color:"purple"}}[t],s={blue:{border:i?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-300",icon:"text-blue-600",title:"text-blue-700",features:"text-blue-600"},purple:{border:i?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-purple-300",icon:"text-purple-600",title:"text-purple-700",features:"text-purple-600"}}[o.color];return e.jsx("div",{className:`border-2 rounded-lg p-6 cursor-pointer transition-all ${s.border}`,onClick:()=>l(t),children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-4xl mb-3 ${s.icon}`,children:o.icon}),e.jsx("h3",{className:`text-xl font-semibold mb-2 ${s.title}`,children:o.title}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:o.description}),e.jsx("ul",{className:"text-left text-sm space-y-1",children:o.features.map((p,d)=>e.jsxs("li",{className:`${s.features}`,children:["• ",p]},d))})]})})}function R(){return e.jsx("div",{className:"text-center mt-6",children:e.jsxs("a",{href:"#",className:"inline-flex items-center text-sm text-blue-600 hover:text-blue-800 transition-colors",onClick:t=>{t.preventDefault(),alert("Support chat would open here. Contact: support@capecontrol.com")},children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Need Help?"]})})}function O({onNext:t,formData:r,setFormData:l}){const[i,g]=a.useState(r.firstName||""),[o,m]=a.useState(r.lastName||""),[s,p]=a.useState(r.email||""),[d,S]=a.useState(r.password||""),[u,E]=a.useState(""),[h,j]=a.useState(r.role||""),[v,x]=a.useState(""),[w,c]=a.useState(null),[y,C]=a.useState(!1),[f,I]=a.useState(!0),P=n=>{const N={minLength:n.length>=12,hasUpper:/[A-Z]/.test(n),hasLower:/[a-z]/.test(n),hasNumber:/[0-9]/.test(n),hasSpecial:/[^A-Za-z0-9]/.test(n)};return{isValid:Object.values(N).every(Boolean),requirements:N}};a.useEffect(()=>{const N=setTimeout(async()=>{if(!s||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)){c(null);return}C(!0);try{const k=await $(s);c(k.available)}catch(k){console.error("Email validation error:",k),c(null)}finally{C(!1)}},500);return()=>clearTimeout(N)},[s]),a.useEffect(()=>{u&&I(d===u)},[d,u]);const B=async n=>{if(n.preventDefault(),x(""),!i.trim()||!o.trim()){x("First and last name are required");return}if(!s||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)){x("Please enter a valid email address");return}if(w===!1){x("This email is already registered. Try logging in or use a different email.");return}if(!P(d).isValid){x("Password must be at least 12 characters with uppercase, lowercase, number, and special character");return}if(d!==u){x("Passwords do not match");return}if(!h){x("Please select your role");return}l({...r,firstName:i.trim(),lastName:o.trim(),email:s.trim().toLowerCase(),password:d,role:h}),t()},b=P(d);return e.jsxs("div",{className:"max-w-4xl mx-auto mt-10 p-8 bg-white rounded-lg shadow-lg",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Your CapeControl Account"}),e.jsx("p",{className:"text-gray-600",children:"Step 1: Basic Information & Role Selection"}),e.jsx(L,{currentStep:1,totalSteps:2})]}),v&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm text-center",children:v})}),e.jsxs("form",{onSubmit:B,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",autoComplete:"username",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:i,onChange:n=>g(n.target.value),placeholder:"Enter your first name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",autoComplete:"username",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:o,onChange:n=>m(n.target.value),placeholder:"Enter your last name",required:!0})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Account Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),e.jsx("input",{type:"email",autoComplete:"username",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s,onChange:n=>p(n.target.value),placeholder:"Enter your email address",required:!0}),e.jsx(z,{email:s,isValid:w,isChecking:y})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx("input",{type:"password",autoComplete:"new-password",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d,onChange:n=>S(n.target.value),placeholder:"Create a strong password",minLength:12,required:!0}),e.jsx(F,{password:d}),d&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium",children:"Password Requirements:"}),e.jsxs("ul",{className:"mt-1 space-y-1",children:[e.jsx("li",{className:b.requirements.minLength?"text-green-600":"text-red-600",children:"✓ At least 12 characters"}),e.jsx("li",{className:b.requirements.hasUpper?"text-green-600":"text-red-600",children:"✓ One uppercase letter"}),e.jsx("li",{className:b.requirements.hasLower?"text-green-600":"text-red-600",children:"✓ One lowercase letter"}),e.jsx("li",{className:b.requirements.hasNumber?"text-green-600":"text-red-600",children:"✓ One number"}),e.jsx("li",{className:b.requirements.hasSpecial?"text-green-600":"text-red-600",children:"✓ One special character"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password *"}),e.jsx("input",{type:"password",autoComplete:"new-password",className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${u&&!f?"border-red-300":"border-gray-300"}`,value:u,onChange:n=>E(n.target.value),placeholder:"Confirm your password",required:!0}),u&&!f&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:"Passwords do not match"}),u&&f&&e.jsx("p",{className:"mt-1 text-xs text-green-600",children:"Passwords match ✓"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Choose Your Role"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Select how you'll use CapeControl to get personalized features"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx(A,{role:"customer",selectedRole:h,onSelect:j}),e.jsx(A,{role:"developer",selectedRole:h,onSelect:j})]})]}),e.jsxs("div",{className:"pt-6",children:[e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 transition-colors font-semibold text-lg disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:y||!f||!b.isValid||!h,children:y?"Checking email...":"Continue to Details →"}),(!b.isValid||!f||!h)&&e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:[!b.isValid&&"Complete password requirements, ",!f&&"confirm password, ",!h&&"select your role ","to continue"]})]}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:["Already have an account?"," ",e.jsx("a",{href:"/login-customer",className:"text-blue-600 hover:underline",children:"Sign in"})]})]}),e.jsx(R,{})]})}function M({formData:t,setFormData:r,onSubmit:l}){const[i,g]=a.useState(t.company||""),[o,m]=a.useState(t.phone||""),[s,p]=a.useState(t.website||""),[d,S]=a.useState(t.experience||""),[u,E]=a.useState(!1),[h,j]=a.useState(!1),[v,x]=a.useState(""),w=async c=>{if(c.preventDefault(),!u){x("You must agree to the Terms & Conditions");return}if(!i.trim()){x("Company/Organization name is required");return}j(!0),x("");const y={...t,company:i.trim(),phone:o.trim(),website:s.trim(),experience:d};try{await l(y)}catch(C){x(C.message)}finally{j(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto mt-10 p-8 bg-white rounded-lg shadow-lg",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Complete Your Profile"}),e.jsxs("p",{className:"text-gray-600",children:["Step 2: ",t.role==="customer"?"Business":"Developer"," Details"]}),e.jsx(L,{currentStep:2,totalSteps:2})]}),v&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-600 text-sm text-center",children:v})}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.role==="customer"?"Company Name":"Developer/Company Name"," *"]}),e.jsx("input",{type:"text",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:i,onChange:c=>g(c.target.value),placeholder:t.role==="customer"?"Your company name":"Your name or company",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:o,onChange:c=>m(c.target.value),placeholder:"+1 (555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Website (Optional)"}),e.jsx("input",{type:"url",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s,onChange:c=>p(c.target.value),placeholder:"https://"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.role==="customer"?"Business Experience":"Development Experience"," *"]}),e.jsxs("select",{className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d,onChange:c=>S(c.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select experience level"}),e.jsx("option",{value:"beginner",children:"Beginner (0-1 years)"}),e.jsx("option",{value:"intermediate",children:"Intermediate (2-5 years)"}),e.jsx("option",{value:"advanced",children:"Advanced (5+ years)"}),e.jsx("option",{value:"expert",children:"Expert (10+ years)"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-gray-50 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"terms",className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:u,onChange:c=>E(c.target.checked)}),e.jsxs("label",{htmlFor:"terms",className:"text-sm text-gray-700",children:["I agree to the"," ",e.jsx("a",{href:"/terms",className:"text-blue-600 hover:underline",target:"_blank",children:"Terms & Conditions"})," ","and"," ",e.jsx("a",{href:"/privacy",className:"text-blue-600 hover:underline",target:"_blank",children:"Privacy Policy"})," ","for ",t.role==="customer"?"Users":"Developers"]})]}),e.jsx("button",{type:"submit",disabled:h||!u,className:`w-full p-4 rounded-lg font-semibold text-lg transition-colors ${h||!u?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white`,children:h?"Creating Account...":"Create Account"})]}),e.jsx(R,{})]})}function Y(){const[t,r]=a.useState(1),[l,i]=a.useState({}),g=T(),o=()=>{r(t+1)},m=async s=>{try{const p=await V(s);s.role==="customer"?g("/phase2-customer",{state:{userData:{...s,...p}}}):g("/phase2-developer",{state:{userData:{...s,...p}}})}catch(p){throw p}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[t===1&&e.jsx(O,{onNext:o,formData:l,setFormData:i}),t===2&&e.jsx(M,{formData:l,setFormData:i,onSubmit:m})]})}export{Y as default};
