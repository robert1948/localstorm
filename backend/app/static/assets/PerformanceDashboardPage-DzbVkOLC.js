import{j as e,r as h,u as E}from"./index-C-buvYrj.js";const $=({systemStatus:s,realTimeData:d,timeWindow:c,onTimeWindowChange:f,autoRefresh:m,onAutoRefreshToggle:v,onRefresh:b,lastUpdate:p,loading:u})=>{var N,j,i,r;const y=o=>{switch(o){case"healthy":return"text-green-600 bg-green-100";case"degraded":return"text-yellow-600 bg-yellow-100";case"unhealthy":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},t=o=>{switch(o){case"healthy":return"✅";case"degraded":return"⚠️";case"unhealthy":return"❌";default:return"❓"}};return e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Performance Dashboard"}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${y(s)}`,children:[e.jsx("span",{className:"mr-1",children:t(s)}),s?s.charAt(0).toUpperCase()+s.slice(1):"Unknown"]}),u&&e.jsxs("div",{className:"flex items-center text-sm text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Updating..."]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[d&&e.jsxs("div",{className:"hidden md:flex items-center space-x-6 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:Math.round(((N=d.quick_stats)==null?void 0:N.requests_per_minute)||0)}),e.jsx("div",{className:"text-gray-500",children:"req/min"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-semibold text-green-600",children:[Math.round(((j=d.quick_stats)==null?void 0:j.avg_response_time)||0),"ms"]}),e.jsx("div",{className:"text-gray-500",children:"response"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`font-semibold ${(((i=d.quick_stats)==null?void 0:i.error_rate)||0)>5?"text-red-600":"text-green-600"}`,children:[(((r=d.quick_stats)==null?void 0:r.error_rate)||0).toFixed(1),"%"]}),e.jsx("div",{className:"text-gray-500",children:"errors"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Time:"}),e.jsxs("select",{value:c,onChange:o=>f(parseInt(o.target.value)),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:1,children:"1 Hour"}),e.jsx("option",{value:6,children:"6 Hours"}),e.jsx("option",{value:24,children:"24 Hours"}),e.jsx("option",{value:72,children:"3 Days"}),e.jsx("option",{value:168,children:"1 Week"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Auto:"}),e.jsx("button",{onClick:v,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${m?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("button",{onClick:b,disabled:u,className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:[e.jsx("span",{className:`${u?"animate-spin":""}`,children:u?"⟳":"🔄"}),e.jsx("span",{children:"Refresh"})]}),e.jsx("div",{className:"relative",children:e.jsx("button",{className:"bg-gray-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-700 transition-colors",onClick:()=>{alert("Export functionality coming soon")},children:"📊 Export"})})]})]}),p&&e.jsx("div",{className:"pb-2",children:e.jsxs("div",{className:"text-xs text-gray-500",children:["Last updated: ",p,m&&e.jsx("span",{className:"ml-2 text-green-600",children:"• Auto-refresh enabled"})]})})]})})},q=({widgets:s,loading:d})=>{if(!s&&!d)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Metrics"}),e.jsx("p",{className:"text-gray-500",children:"No system metrics available"})]});const c=s.filter(t=>t.id.includes("cpu")||t.id.includes("memory")||t.id.includes("disk")||t.id.includes("system")),f=s.filter(t=>t.id.includes("request")||t.id.includes("response")||t.id.includes("error")),m=t=>{switch(t){case"healthy":return"text-green-600 bg-green-50 border-green-200";case"warning":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"critical":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},v=t=>{switch(t){case"up":return"📈";case"down":return"📉";case"stable":return"➡️";default:return"─"}},b=t=>t.includes("cpu")?"💻":t.includes("memory")?"🧠":t.includes("disk")?"💾":t.includes("request")?"🚀":t.includes("response")?"⚡":t.includes("error")?"⚠️":t.includes("system")?"🖥️":"📊",p=(t,N)=>typeof t=="number"?t>1e3&&N!=="%"?(t/1e3).toFixed(1)+"K":t.toFixed(1):t,u=({widget:t})=>{var N,j;return e.jsxs("div",{className:`p-4 rounded-lg border ${m(t.status)} transition-all duration-300 hover:shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:b(t.id)}),e.jsx("h4",{className:"font-medium text-gray-900",children:t.title})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm",children:v(t.trend)}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${m(t.status)}`,children:t.status})]})]}),e.jsxs("div",{className:"flex items-baseline space-x-2",children:[e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:p(t.value,t.unit)}),t.unit&&e.jsx("span",{className:"text-sm text-gray-500",children:t.unit})]}),t.unit==="%"&&typeof t.value=="number"&&e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${t.status==="healthy"?"bg-green-500":t.status==="warning"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(t.value,100)}%`}})})}),((N=t.metadata)==null?void 0:N.threshold_warning)&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Warning: ",t.metadata.threshold_warning,t.unit,((j=t.metadata)==null?void 0:j.threshold_critical)&&e.jsxs("span",{className:"ml-2",children:["Critical: ",t.metadata.threshold_critical,t.unit]})]})]})},y=()=>e.jsx("div",{className:"p-4 rounded-lg border border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-24"})]}),e.jsx("div",{className:"h-6 bg-gray-300 rounded w-16"})]}),e.jsx("div",{className:"h-8 bg-gray-300 rounded w-20 mb-3"}),e.jsx("div",{className:"w-full bg-gray-300 rounded-full h-2"})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🖥️"}),"System Resources"]}),e.jsx("div",{className:"space-y-4",children:d?e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx(y,{}),e.jsx(y,{})]}):c.length>0?c.map(t=>e.jsx(u,{widget:t},t.id)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No system metrics available"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"📊"}),"Performance Metrics"]}),e.jsx("div",{className:"space-y-4",children:d?e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx(y,{})]}):f.length>0?f.map(t=>e.jsx(u,{widget:t},t.id)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No performance metrics available"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🎯"}),"Status Summary"]}),e.jsx("div",{className:"space-y-3",children:d?e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Overall Health"}),e.jsx("span",{className:`text-sm font-medium ${c.every(t=>t.status==="healthy")?"text-green-600":c.some(t=>t.status==="critical")?"text-red-600":"text-yellow-600"}`,children:c.every(t=>t.status==="healthy")?"Excellent":c.some(t=>t.status==="critical")?"Needs Attention":"Good"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active Widgets"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c.length+f.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Last Update"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:new Date().toLocaleTimeString()})]})]})})]})]})},R=({timeWindow:s,loading:d})=>{const[c,f]=h.useState(null),[m,v]=h.useState(!0),[b,p]=h.useState(null),[u,y]=h.useState("system_resources");h.useEffect(()=>{(async()=>{try{v(!0);const r=localStorage.getItem("token");if(!r)return;const o=await fetch(`/api/dashboard/charts?hours=${s}`,{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(o.ok){const g=await o.json();f(g),p(null)}else throw new Error(`HTTP ${o.status}`)}catch(r){console.error("Error fetching charts data:",r),p("Failed to load charts data")}finally{v(!1)}})()},[s]);const t=({data:i,label:r,color:o="blue",unit:g=""})=>{var l;if(!i||i.length===0)return e.jsx("div",{className:"h-32 flex items-center justify-center text-gray-500",children:"No data available"});const _=Math.max(...i),w=Math.min(...i),a=_-w||1;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-2",children:[e.jsx("span",{children:r}),e.jsxs("span",{children:[_.toFixed(1),g]})]}),e.jsx("div",{className:"h-32 relative border border-gray-200 rounded bg-gray-50",children:e.jsx("svg",{className:"w-full h-full",children:e.jsx("polyline",{fill:"none",stroke:o==="blue"?"#3B82F6":o==="green"?"#10B981":"#EF4444",strokeWidth:"2",points:i.map((n,x)=>{const k=x/(i.length-1)*100,S=100-(n-w)/a*100;return`${k}%,${S}%`}).join(" ")})})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:[w.toFixed(1),g]}),e.jsxs("span",{className:"text-center",children:["Current: ",(l=i[i.length-1])==null?void 0:l.toFixed(1),g]})]})]})},N=[{id:"system_resources",label:"System Resources",icon:"🖥️"},{id:"request_volume",label:"Request Volume",icon:"🚀"},{id:"error_rate",label:"Error Rate",icon:"⚠️"},{id:"response_times",label:"Response Times",icon:"⚡"}],j=()=>{var i,r;if(m||!c)return e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});switch(u){case"system_resources":return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(t,{data:((i=c.system_resources)==null?void 0:i.cpu)||[],label:"CPU Usage",color:"blue",unit:"%"}),e.jsx(t,{data:((r=c.system_resources)==null?void 0:r.memory)||[],label:"Memory Usage",color:"green",unit:"%"})]});case"request_volume":return e.jsx(t,{data:c.request_volume||[],label:"Requests per Hour",color:"blue",unit:" req"});case"error_rate":return e.jsx(t,{data:c.error_rate||[],label:"Error Rate",color:"red",unit:"%"});case"response_times":return e.jsx(t,{data:c.response_times||[],label:"Average Response Time",color:"green",unit:"ms"});default:return e.jsx("div",{children:"Unknown chart type"})}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Charts"}),c&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Time range: ",s," hours"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:N.map(i=>e.jsxs("button",{onClick:()=>y(i.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-2 ${u===i.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx("span",{children:i.icon}),e.jsx("span",{children:i.label})]},i.id))}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-red-400 text-xl mr-2",children:"⚠️"}),e.jsx("span",{className:"text-red-800",children:b})]})}),e.jsx("div",{className:"min-h-64",children:j()}),c&&c.time_buckets&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("span",{children:["Data points: ",c.time_buckets.length]}),e.jsxs("span",{children:["From: ",new Date(c.time_buckets[0]).toLocaleString()," "," to "," ",new Date(c.time_buckets[c.time_buckets.length-1]).toLocaleString()]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Chart Information:"})}),e.jsxs("ul",{className:"space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"System Resources:"})," Real-time CPU and memory usage"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Request Volume:"})," Number of API requests over time"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Error Rate:"})," Percentage of failed requests"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Response Times:"})," Average API response latency"]})]})]})})]})},L=({alerts:s,loading:d})=>{const[c,f]=h.useState("all"),[m,v]=h.useState(null),b=r=>{switch(r){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-red-600 bg-red-50 border-red-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},p=r=>{switch(r){case"critical":return"🚨";case"high":return"⚠️";case"medium":return"⚡";case"low":return"ℹ️";default:return"📋"}},u=r=>{switch(r){case"system":return"🖥️";case"performance":return"📊";case"security":return"🔒";case"network":return"🌐";default:return"📋"}},y=(s==null?void 0:s.filter(r=>c==="all"?!0:r.severity===c))||[],t={all:(s==null?void 0:s.length)||0,critical:(s==null?void 0:s.filter(r=>r.severity==="critical").length)||0,high:(s==null?void 0:s.filter(r=>r.severity==="high").length)||0,medium:(s==null?void 0:s.filter(r=>r.severity==="medium").length)||0,low:(s==null?void 0:s.filter(r=>r.severity==="low").length)||0},N=async r=>{try{const o=localStorage.getItem("token");(await fetch(`/api/dashboard/alerts/${r}/acknowledge`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).ok&&console.log(`Alert ${r} acknowledged`)}catch(o){console.error("Error acknowledging alert:",o)}},j=({alert:r})=>e.jsxs("div",{className:`p-4 rounded-lg border ${b(r.severity)} transition-all duration-300 hover:shadow-md`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xl",children:p(r.severity)}),e.jsx("span",{className:"text-sm",children:u(r.type)})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 truncate",children:r.title}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${b(r.severity)}`,children:r.severity})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:r.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Type: ",r.type]}),e.jsx("span",{children:new Date(r.timestamp).toLocaleString()})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>v(m===r.id?null:r.id),className:"text-gray-400 hover:text-gray-600 transition-colors",title:"View details",children:m===r.id?"📖":"📄"}),e.jsx("button",{onClick:()=>N(r.id),className:"text-blue-600 hover:text-blue-800 transition-colors text-sm",title:"Acknowledge alert",children:"✓"})]})]}),m===r.id&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Alert ID:"})," ",r.id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Timestamp:"})," ",new Date(r.timestamp).toLocaleString()]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"})," ",r.type]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Severity:"})," ",r.severity]}),r.metadata&&e.jsxs("div",{children:[e.jsx("strong",{children:"Additional Info:"}),e.jsx("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(r.metadata,null,2)})]})]})})]}),i=()=>e.jsx("div",{className:"p-4 rounded-lg border border-gray-200 bg-gray-50",children:e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]})]})})});return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"🚨"}),"System Alerts",t.all>0&&e.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-sm px-2 py-1 rounded-full",children:t.all})]}),!d&&s&&s.length>0&&e.jsxs("div",{className:"text-sm text-gray-500",children:[y.length," of ",s.length," alerts"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:[{key:"all",label:"All",count:t.all},{key:"critical",label:"Critical",count:t.critical},{key:"high",label:"High",count:t.high},{key:"medium",label:"Medium",count:t.medium},{key:"low",label:"Low",count:t.low}].map(({key:r,label:o,count:g})=>e.jsxs("button",{onClick:()=>f(r),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-2 ${c===r?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,disabled:g===0&&r!=="all",children:[e.jsx("span",{children:o}),g>0&&e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${c===r?"bg-white text-blue-600":"bg-gray-200 text-gray-700"}`,children:g})]},r))}),e.jsx("div",{className:"space-y-4",children:d?e.jsxs(e.Fragment,{children:[e.jsx(i,{}),e.jsx(i,{}),e.jsx(i,{})]}):y.length>0?y.map(r=>e.jsx(j,{alert:r},r.id)):s&&s.length>0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"🔍"}),e.jsx("p",{children:"No alerts matching current filter"})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"✅"}),e.jsx("p",{className:"text-lg font-medium",children:"No Active Alerts"}),e.jsx("p",{className:"text-sm",children:"Your system is running smoothly"})]})}),s&&s.length>0&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{className:"text-red-600",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.critical+t.high}),e.jsx("div",{className:"text-xs text-gray-600",children:"High Priority"})]}),e.jsxs("div",{className:"text-yellow-600",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.medium}),e.jsx("div",{className:"text-xs text-gray-600",children:"Medium Priority"})]}),e.jsxs("div",{className:"text-blue-600",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.low}),e.jsx("div",{className:"text-xs text-gray-600",children:"Low Priority"})]}),e.jsxs("div",{className:"text-gray-600",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.all}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Active"})]})]})})]})},P=({loading:s})=>{var g,_,w;const[d,c]=h.useState(null),[f,m]=h.useState(!0),[v,b]=h.useState(null),[p,u]=h.useState("volume");h.useEffect(()=>{(async()=>{try{m(!0);const l=localStorage.getItem("token");if(!l)return;const n=await fetch("/api/dashboard/analytics/endpoints",{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(n.ok){const x=await n.json();c(x),b(null)}else throw new Error(`HTTP ${n.status}`)}catch(l){console.error("Error fetching analytics data:",l),b("Failed to load endpoint analytics")}finally{m(!1)}})()},[]);const y=[{id:"volume",label:"Top by Volume",icon:"📊"},{id:"errors",label:"Top by Errors",icon:"⚠️"},{id:"slowest",label:"Slowest Endpoints",icon:"🐌"}],t=a=>a.includes("/api/auth")?"text-blue-600 bg-blue-50":a.includes("/api/cape")?"text-green-600 bg-green-50":a.includes("/api/monitoring")?"text-purple-600 bg-purple-50":a.includes("/api/dashboard")?"text-orange-600 bg-orange-50":a.includes("/api/health")?"text-teal-600 bg-teal-50":"text-gray-600 bg-gray-50",N=a=>a.includes("GET")?"text-green-600 bg-green-100":a.includes("POST")?"text-blue-600 bg-blue-100":a.includes("PUT")?"text-yellow-600 bg-yellow-100":a.includes("DELETE")?"text-red-600 bg-red-100":"text-gray-600 bg-gray-100",j=a=>{const l=a.split(" "),n=l[0]||"GET",x=l.slice(1).join(" ")||a;return{method:n,path:x.length>40?x.substring(0,40)+"...":x}},i=({endpoint:a,data:l,index:n,type:x})=>{var C,A;const{method:k,path:S}=j(a);return e.jsx("div",{className:`p-4 rounded-lg border ${t(a)} transition-all duration-300 hover:shadow-md`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm font-bold text-gray-600",children:n+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-mono rounded ${N(a)}`,children:k}),e.jsx("span",{className:"font-medium text-gray-900 truncate",children:S})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[x==="volume"&&e.jsxs(e.Fragment,{children:[(C=l.requests)==null?void 0:C.toLocaleString()," requests • Avg: ",l.avg_response_time,"ms"]}),x==="errors"&&e.jsxs(e.Fragment,{children:[l.errors," errors • Rate: ",l.error_rate,"%"]}),x==="slowest"&&e.jsxs(e.Fragment,{children:["Avg: ",l.avg_response_time,"ms • Max: ",l.max_response_time,"ms"]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0",children:[x==="volume"&&e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-semibold text-blue-600",children:(A=l.requests)==null?void 0:A.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500",children:"requests"})]}),x==="errors"&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-semibold text-red-600",children:[l.error_rate,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[l.errors," errors"]})]}),x==="slowest"&&e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-semibold text-yellow-600",children:[l.avg_response_time,"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"avg time"})]})]})]})})},r=()=>e.jsx("div",{className:"p-4 rounded-lg border border-gray-200 bg-gray-50",children:e.jsx("div",{className:"animate-pulse",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-300 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded w-1/2"})]}),e.jsx("div",{className:"w-16 h-8 bg-gray-300 rounded"})]})})}),o=()=>{if(f||!d)return e.jsxs("div",{className:"space-y-4",children:[e.jsx(r,{}),e.jsx(r,{}),e.jsx(r,{}),e.jsx(r,{}),e.jsx(r,{})]});let a=[],l=p;switch(p){case"volume":a=d.top_by_volume||[];break;case"errors":a=d.top_by_errors||[];break;case"slowest":a=d.slowest_endpoints||[];break}return a.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-4xl mb-2",children:"📊"}),e.jsx("p",{children:"No endpoint data available"})]}):e.jsx("div",{className:"space-y-4",children:a.slice(0,10).map((n,x)=>e.jsx(i,{endpoint:n.endpoint,data:n,index:x,type:l},`${n.endpoint}-${x}`))})};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Endpoint Analytics"}),d&&e.jsxs("div",{className:"text-sm text-gray-500",children:[d.total_endpoints," total endpoints"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:y.map(a=>e.jsxs("button",{onClick:()=>u(a.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center space-x-2 ${p===a.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx("span",{children:a.icon}),e.jsx("span",{children:a.label})]},a.id))}),v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-red-400 text-xl mr-2",children:"⚠️"}),e.jsx("span",{className:"text-red-800",children:v})]})}),o(),d&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.total_endpoints}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Endpoints"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:((_=(g=d.top_by_volume)==null?void 0:g.reduce((a,l)=>a+(l.requests||0),0))==null?void 0:_.toLocaleString())||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Requests"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:((w=d.top_by_errors)==null?void 0:w.reduce((a,l)=>a+(l.errors||0),0))||0}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Errors"})]})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Endpoint Categories:"})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-50 border border-blue-200 rounded"}),e.jsx("span",{children:"Authentication"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-50 border border-green-200 rounded"}),e.jsx("span",{children:"AI Services"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-50 border border-purple-200 rounded"}),e.jsx("span",{children:"Monitoring"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-50 border border-orange-200 rounded"}),e.jsx("span",{children:"Dashboard"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-teal-50 border border-teal-200 rounded"}),e.jsx("span",{children:"Health"})]})]})]})})]})},M=({realTimeData:s,loading:d})=>{var m,v,b,p,u,y,t,N,j,i,r,o,g,_,w,a,l;if(!s&&!d)return null;const c=[{id:"requests_per_minute",title:"Requests/Minute",value:((m=s==null?void 0:s.quick_stats)==null?void 0:m.requests_per_minute)||0,unit:"req/min",icon:"🚀",color:"blue",format:n=>Math.round(n)},{id:"avg_response_time",title:"Avg Response Time",value:((v=s==null?void 0:s.quick_stats)==null?void 0:v.avg_response_time)||0,unit:"ms",icon:"⚡",color:((b=s==null?void 0:s.quick_stats)==null?void 0:b.avg_response_time)>1e3?"yellow":"green",format:n=>Math.round(n)},{id:"error_rate",title:"Error Rate",value:((p=s==null?void 0:s.quick_stats)==null?void 0:p.error_rate)||0,unit:"%",icon:"⚠️",color:((u=s==null?void 0:s.quick_stats)==null?void 0:u.error_rate)>5?"red":((y=s==null?void 0:s.quick_stats)==null?void 0:y.error_rate)>2?"yellow":"green",format:n=>n.toFixed(2)},{id:"active_errors",title:"Active Errors",value:((t=s==null?void 0:s.quick_stats)==null?void 0:t.active_errors)||0,unit:"errors",icon:"🔥",color:((N=s==null?void 0:s.quick_stats)==null?void 0:N.active_errors)>10?"red":((j=s==null?void 0:s.quick_stats)==null?void 0:j.active_errors)>0?"yellow":"green",format:n=>Math.round(n)},{id:"cpu_percent",title:"CPU Usage",value:((i=s==null?void 0:s.system_health)==null?void 0:i.cpu_percent)||0,unit:"%",icon:"💻",color:((r=s==null?void 0:s.system_health)==null?void 0:r.cpu_percent)>80?"red":((o=s==null?void 0:s.system_health)==null?void 0:o.cpu_percent)>70?"yellow":"green",format:n=>Math.round(n)},{id:"memory_percent",title:"Memory Usage",value:((g=s==null?void 0:s.system_health)==null?void 0:g.memory_percent)||0,unit:"%",icon:"🧠",color:((_=s==null?void 0:s.system_health)==null?void 0:_.memory_percent)>85?"red":((w=s==null?void 0:s.system_health)==null?void 0:w.memory_percent)>75?"yellow":"green",format:n=>Math.round(n)}],f=(n,x=!1)=>{const k={blue:x?"bg-blue-50 border-blue-200":"text-blue-600",green:x?"bg-green-50 border-green-200":"text-green-600",yellow:x?"bg-yellow-50 border-yellow-200":"text-yellow-600",red:x?"bg-red-50 border-red-200":"text-red-600",gray:x?"bg-gray-50 border-gray-200":"text-gray-600"};return k[n]||k.gray};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Real-time Metrics"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Live"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:c.map(n=>e.jsxs("div",{className:`p-4 rounded-lg border ${f(n.color,!0)} transition-all duration-300 hover:shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-2xl",children:n.icon}),d&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"})]}),e.jsx("div",{className:`text-2xl font-bold ${f(n.color)} mb-1`,children:d?e.jsx("div",{className:"animate-pulse bg-gray-200 h-6 w-12 rounded"}):e.jsxs(e.Fragment,{children:[n.format(n.value),e.jsx("span",{className:"text-sm font-normal text-gray-500 ml-1",children:n.unit})]})}),e.jsx("div",{className:"text-xs text-gray-600",children:n.title})]},n.id))}),s&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["System Status:",e.jsx("span",{className:`ml-1 font-medium ${s.system_status==="healthy"?"text-green-600":s.system_status==="degraded"?"text-yellow-600":"text-red-600"}`,children:((a=s.system_status)==null?void 0:a.charAt(0).toUpperCase())+((l=s.system_status)==null?void 0:l.slice(1))})]}),s.alerts_count>0&&e.jsxs("span",{className:"text-red-600",children:["🚨 ",s.alerts_count," active alert",s.alerts_count!==1?"s":""]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Updated: ",new Date(s.timestamp).toLocaleTimeString()]})]})})]})},F=()=>{const[s,d]=h.useState(null),[c,f]=h.useState(null),[m,v]=h.useState(!0),[b,p]=h.useState(null),[u,y]=h.useState(24),[t,N]=h.useState(!0),[j,i]=h.useState(null),r=E(),o=h.useCallback(async()=>{try{const l=localStorage.getItem("token");if(!l){r("/login");return}const n=await fetch(`/api/dashboard/?time_window=${u}`,{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(n.ok){const x=await n.json();d(x),i(new Date().toLocaleTimeString()),p(null)}else if(n.status===401)r("/login");else throw new Error(`HTTP ${n.status}`)}catch(l){console.error("Error fetching dashboard data:",l),p("Failed to load dashboard data")}},[u,r]),g=h.useCallback(async()=>{try{const l=localStorage.getItem("token");if(!l)return;const n=await fetch("/api/dashboard/real-time",{headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"}});if(n.ok){const x=await n.json();f(x)}}catch(l){console.error("Error fetching real-time data:",l)}},[]);h.useEffect(()=>{(async()=>{v(!0),await Promise.all([o(),g()]),v(!1)})()},[o,g]),h.useEffect(()=>{if(!t)return;const l=setInterval(()=>{g(),(!j||new Date-new Date(j)>12e4)&&o()},1e4);return()=>clearInterval(l)},[t,o,g,j]);const _=l=>{y(l)},w=async()=>{v(!0),await Promise.all([o(),g()]),v(!1)},a=()=>{N(!t)};return m&&!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 text-lg",children:"Loading Performance Dashboard..."})]})}):b&&!s?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Dashboard Error"}),e.jsx("p",{className:"text-gray-600 mb-4",children:b}),e.jsx("button",{onClick:w,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Retry"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx($,{systemStatus:s==null?void 0:s.system_status,realTimeData:c,timeWindow:u,onTimeWindowChange:_,autoRefresh:t,onAutoRefreshToggle:a,onRefresh:w,lastUpdate:j,loading:m}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"text-red-400 text-xl mr-3",children:"⚠️"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-red-800 font-medium",children:"Dashboard Warning"}),e.jsx("p",{className:"text-red-600 text-sm mt-1",children:b})]}),e.jsx("button",{onClick:()=>p(null),className:"text-red-400 hover:text-red-600",children:"×"})]})}),e.jsx("div",{className:"mb-8",children:e.jsx(M,{realTimeData:c,loading:m})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx(q,{widgets:(s==null?void 0:s.widgets)||[],loading:m})}),e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsx(R,{timeWindow:u,loading:m}),e.jsx(P,{loading:m})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(L,{alerts:(s==null?void 0:s.alerts)||[],loading:m})}),(s==null?void 0:s.performance_summary)&&e.jsx("div",{className:"mt-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Summary"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:Object.entries(s.performance_summary.key_metrics||{}).map(([l,n])=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n}),e.jsx("div",{className:"text-sm text-gray-600 capitalize",children:l.replace(/_/g," ")})]},l))}),s.performance_summary.recommendations&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Recommendations"}),e.jsx("ul",{className:"space-y-1",children:s.performance_summary.recommendations.map((l,n)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"text-blue-600 mr-2",children:"•"}),l]},n))})]})]})}),e.jsxs("div",{className:"mt-8 text-center text-sm text-gray-500",children:[e.jsx("p",{children:"LocalStorm Performance Dashboard v3.0.0"}),j&&e.jsxs("p",{children:["Last updated: ",j]})]})]})]})},U=()=>e.jsx(F,{});export{U as default};
